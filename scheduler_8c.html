<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>STM32 RTC Scheduler: source/scheduler.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">STM32 RTC Scheduler
   </div>
   <div id="projectbrief">RTC-based scheduler for ultra-low power applications</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('scheduler_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">scheduler.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file contains the RTC-based scheduler function implementations.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="scheduler_8h_source.html">scheduler.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rtc_8h_source.html">rtc.h</a>&quot;</code><br />
</div>
<p><a href="scheduler_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:addf59bbf653abe1a545fa021bcfdd0fe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8c.html#addf59bbf653abe1a545fa021bcfdd0fe">Scheduler_ProcessRemainingTime</a> (const uint32_t elapsedTime)</td></tr>
<tr class="memdesc:addf59bbf653abe1a545fa021bcfdd0fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function calculates the remaining time for each job.  <a href="scheduler_8c.html#addf59bbf653abe1a545fa021bcfdd0fe">More...</a><br /></td></tr>
<tr class="separator:addf59bbf653abe1a545fa021bcfdd0fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac10e2415498c3aef7fb7b549547919ac"><td class="memItemLeft" align="right" valign="top"><a id="ac10e2415498c3aef7fb7b549547919ac"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8c.html#ac10e2415498c3aef7fb7b549547919ac">SchedulerInit</a> (void)</td></tr>
<tr class="memdesc:ac10e2415498c3aef7fb7b549547919ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the scheduler by setting its structure values to zero. <br /></td></tr>
<tr class="separator:ac10e2415498c3aef7fb7b549547919ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8435ebcb7ddc15e8ad10a4f2a583da7"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8c.html#ae8435ebcb7ddc15e8ad10a4f2a583da7">SchedulerAddJob</a> (const uint32_t period, const <a class="el" href="scheduler_8h.html#aec2274e2b7e0371426d17567a0b3e7ac">Callback_t</a> callback)</td></tr>
<tr class="memdesc:ae8435ebcb7ddc15e8ad10a4f2a583da7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a new job to the scheduler.  <a href="scheduler_8c.html#ae8435ebcb7ddc15e8ad10a4f2a583da7">More...</a><br /></td></tr>
<tr class="separator:ae8435ebcb7ddc15e8ad10a4f2a583da7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac007d278ad802915ec0f9836a31f35d0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8c.html#ac007d278ad802915ec0f9836a31f35d0">SchedulerProcess</a> (void)</td></tr>
<tr class="memdesc:ac007d278ad802915ec0f9836a31f35d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process the scheduler.  <a href="scheduler_8c.html#ac007d278ad802915ec0f9836a31f35d0">More...</a><br /></td></tr>
<tr class="separator:ac007d278ad802915ec0f9836a31f35d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac73d0e62bf6bf2ac8806c6bcd370f528"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8c.html#ac73d0e62bf6bf2ac8806c6bcd370f528">SchedulerExecutePendingJobs</a> (void)</td></tr>
<tr class="memdesc:ac73d0e62bf6bf2ac8806c6bcd370f528"><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute the pending jobs.  <a href="scheduler_8c.html#ac73d0e62bf6bf2ac8806c6bcd370f528">More...</a><br /></td></tr>
<tr class="separator:ac73d0e62bf6bf2ac8806c6bcd370f528"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52404af44a059ff445c0ce4c5353ebc0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8c.html#a52404af44a059ff445c0ce4c5353ebc0">SchedulerStop</a> (void)</td></tr>
<tr class="memdesc:a52404af44a059ff445c0ce4c5353ebc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop the scheduler.  <a href="scheduler_8c.html#a52404af44a059ff445c0ce4c5353ebc0">More...</a><br /></td></tr>
<tr class="separator:a52404af44a059ff445c0ce4c5353ebc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a43926f6576c08563b9035fe2b1115638"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_scheduler__t.html">Scheduler_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8c.html#a43926f6576c08563b9035fe2b1115638">scheduler</a></td></tr>
<tr class="separator:a43926f6576c08563b9035fe2b1115638"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains the RTC-based scheduler function implementations. </p>
<p>STM32 RTC Scheduler</p>
<dl class="section author"><dt>Author</dt><dd>Akos Pasztor</dd></dl>
<dl class="section see"><dt>See also</dt><dd>Please refer to README for detailed information.</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>(c) 2021 Akos Pasztor. <a href="https://akospasztor.com">https://akospasztor.com</a> </dd></dl>

<p class="definition">Definition in file <a class="el" href="scheduler_8c_source.html">scheduler.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="addf59bbf653abe1a545fa021bcfdd0fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addf59bbf653abe1a545fa021bcfdd0fe">&#9670;&nbsp;</a></span>Scheduler_ProcessRemainingTime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Scheduler_ProcessRemainingTime </td>
          <td>(</td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>elapsedTime</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function calculates the remaining time for each job. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">elapsedTime</td><td>The elapsed time since the launch of the scheduler. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="scheduler_8c_source.html#l00220">220</a> of file <a class="el" href="scheduler_8c_source.html">scheduler.c</a>.</p>

</div>
</div>
<a id="ae8435ebcb7ddc15e8ad10a4f2a583da7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8435ebcb7ddc15e8ad10a4f2a583da7">&#9670;&nbsp;</a></span>SchedulerAddJob()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t SchedulerAddJob </td>
          <td>(</td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>period</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="scheduler_8h.html#aec2274e2b7e0371426d17567a0b3e7ac">Callback_t</a>&#160;</td>
          <td class="paramname"><em>callback</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a new job to the scheduler. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">period</td><td>The period in [s] which the job needs to be executed. </td></tr>
    <tr><td class="paramname">callback</td><td>The callback function that is called upon job execution. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A non-zero value if the job has been successfully added; othwerwise zero. </dd></dl>

<p class="definition">Definition at line <a class="el" href="scheduler_8c_source.html#l00043">43</a> of file <a class="el" href="scheduler_8c_source.html">scheduler.c</a>.</p>

</div>
</div>
<a id="ac73d0e62bf6bf2ac8806c6bcd370f528"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac73d0e62bf6bf2ac8806c6bcd370f528">&#9670;&nbsp;</a></span>SchedulerExecutePendingJobs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SchedulerExecutePendingJobs </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Execute the pending jobs. </p>
<p>This function checks the current state of each job. If a job is pending, its callback is executed.</p>
<dl class="section note"><dt>Note</dt><dd>The processing function of the scheduler does not automatically execute the callbacks of the pending jobs. Therefore, this function must be called after calling the processing function of the scheduler.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Depending on the implementation, this function may be called from an interrupt context, or a task context (or both). Consequently, the callback functions of the jobs are executed from the same context. This must be taken into account, i.e. care must be taken upon writing the callbacks of the jobs. For instance, calling this function from an ISR means that the jobs are also executed within the context of the ISR, thus the callbacks must not block and they can only call interrupt-safe RTOS API functions. </dd></dl>

<p class="definition">Definition at line <a class="el" href="scheduler_8c_source.html#l00159">159</a> of file <a class="el" href="scheduler_8c_source.html">scheduler.c</a>.</p>

</div>
</div>
<a id="ac007d278ad802915ec0f9836a31f35d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac007d278ad802915ec0f9836a31f35d0">&#9670;&nbsp;</a></span>SchedulerProcess()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SchedulerProcess </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process the scheduler. </p>
<p>This function needs to be called each time upon an RTC alarm interrupt. The function checks all jobs whether they need to be executed and sets the appropriate pending flags.</p>
<dl class="section note"><dt>Note</dt><dd>The function does not automatically execute the callbacks of the pending jobs to provide more flexibility for the application. The pending jobs can be executed by calling the <a class="el" href="scheduler_8c.html#ac73d0e62bf6bf2ac8806c6bcd370f528" title="Execute the pending jobs.">SchedulerExecutePendingJobs()</a> function. </dd></dl>

<p class="definition">Definition at line <a class="el" href="scheduler_8c_source.html#l00085">85</a> of file <a class="el" href="scheduler_8c_source.html">scheduler.c</a>.</p>

</div>
</div>
<a id="a52404af44a059ff445c0ce4c5353ebc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52404af44a059ff445c0ce4c5353ebc0">&#9670;&nbsp;</a></span>SchedulerStop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SchedulerStop </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stop the scheduler. </p>
<p>This function stops the running scheduler and deactivates the RTC alarm. The function also processes the jobs.</p>
<dl class="section note"><dt>Note</dt><dd>The function does not automatically execute the callbacks of the pending jobs to provide more flexibility for the application. The pending jobs can be executed by calling the <a class="el" href="scheduler_8c.html#ac73d0e62bf6bf2ac8806c6bcd370f528" title="Execute the pending jobs.">SchedulerExecutePendingJobs()</a> function. </dd></dl>

<p class="definition">Definition at line <a class="el" href="scheduler_8c_source.html#l00188">188</a> of file <a class="el" href="scheduler_8c_source.html">scheduler.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a43926f6576c08563b9035fe2b1115638"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43926f6576c08563b9035fe2b1115638">&#9670;&nbsp;</a></span>scheduler</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_scheduler__t.html">Scheduler_t</a> scheduler</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The scheduler object </p>

<p class="definition">Definition at line <a class="el" href="scheduler_8c_source.html#l00020">20</a> of file <a class="el" href="scheduler_8c_source.html">scheduler.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="scheduler_8c.html">scheduler.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
